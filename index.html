<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>Arduino Commander</title>
  <script>
    function sendCommand() {
      var commandValue = document.getElementById("command-input").value;
      var command = "00";
      if(commandValue < 50) {
        if(commandValue != 0) {
          var command = "0" + Math.floor((50 - commandValue) / 5);
        } else {
          var command = "09";
        }
      } else {
        if(commandValue < 100) {
          var command = Math.floor((commandValue - 50) / 5) + "0";
        } else {
          var command = "90";
        }
      }

      var xhttp = new XMLHttpRequest();
      xhttp.onreadystatechange = function() {
        if (xhttp.readyState == 4 && xhttp.status == 200) {
          document.getElementById("status").innerHTML = xhttp.responseText;
        }
      };
      xhttp.open("POST", "set-command", true);
      xhttp.setRequestHeader("Content-type", "application/json");
      //xhttp.send(JSON.stringify({command: command}));
      console.log("commandValue: " + commandValue);
      console.log("command: " + command);
      document.getElementById("command-value").innerHTML = commandValue;
      document.getElementById("command-result").innerHTML = command;
    }
  </script>
</head>
<body>
  <p>Write command: </p>
  <input name="command-input" id="command-input" type="range" list="a-values" oninput="sendCommand()">
  <datalist id="a-values">
   <option value="0" label="Low">
   <option value="100" label="High">
  </datalist>
  <button onclick="document.getElementById('command-input').value = 50; sendCommand();">Stop</button>
  <hr>
  <p>Value: <span id="command-value"></span></p>
  <p>Command: <span id="command-result"></span></p>
  <p>Status: <span id="status"></span></p>
</body>
</html>
